<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Ninja Mobile</title>
</head>

<body>
    <button id="request" onclick="permission()">Request</button>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"
        integrity="sha384-2huaZvOR9iDzHqslqwpR87isEmrfxqyWOF7hr7BY6KG0+hVKLoEXMPUJw3ynWuhO"
        crossorigin="anonymous"></script>
    <script>

        const socket = io();

        function accelerationHandler(acceleration) {
            socket.emit('acceleration', JSON.stringify(acceleration))
            console.log(acceleration)
            // document.body.innerText = JSON.stringify(acceleration)
        }

        function rotationHandler(rotation) {
            socket.emit('rotation', rotation)
            console.log(rotation)
        }
        
        function handleMotion(event) {
            const { acceleration, rotationRate, interval } = event;
            const data = {
              acceleration: {
                x: acceleration.x,
                y: acceleration.y,
                z: acceleration.z
              },
              rotationRate: {
                alpha: rotationRate.alpha,
                beta: rotationRate.beta,
                gamma: rotationRate.gamma
              },
              interval
            };
            
            socket.emit('acceleration', data);
            dataElement.textContent = JSON.stringify(data, null, 2);
          }

          if (typeof DeviceMotionEvent.requestPermission === 'function') {
            DeviceMotionEvent.requestPermission()
              .then(permissionState => {
                if (permissionState === 'granted') {
                  window.addEventListener('devicemotion', handleMotion);
                }
              })
              .catch(console.error);
          } else {
            window.addEventListener('deviceorientation', handleMotion);
          }
    </script>
</body>

</html>